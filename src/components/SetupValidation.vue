<script setup lang="ts">
import { useSpaceForm } from '@/composables/useSpaceForm';

const { form, getErrorMessage } = useSpaceForm('setup');

defineProps<{
  creatingSpace: boolean;
}>();

const emit = defineEmits(['create', 'back']);
</script>

<template>
  <h4 class="mb-2 px-4 md:px-0">
    {{ $t('setup.validationTitle') }}
  </h4>
  <div class="space-y-4">
    <SettingsValidationBlock
      v-model:validation="form.validation"
      :get-error-message="getErrorMessage"
      :filters="form.filters"
      @update:min-score="val => (form.filters.minScore = val)"
      @update:only-members="val => (form.filters.onlyMembers = val)"
    />

    <SettingsAdminsBlock
      :admins="form.admins"
      :error="getErrorMessage('admins')"
      @update:admins="val => (form.admins = val)"
    />

    <SettingsAuthorsBlock
      :members="form.members"
      :error="getErrorMessage('members')"
      @update:members="val => (form.members = val)"
    />
  </div>
  <div class="px-4 md:px-0">
    <SetupButtonCreate
      :creating-space="creatingSpace"
      class="mt-4"
      @create="emit('create')"
    />
    <SetupButtonBack @click="emit('back')" />
  </div>
</template>
